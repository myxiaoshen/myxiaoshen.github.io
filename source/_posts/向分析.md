title: 'Android逆向分析笔记 '
author: ' '
tags:
  - 笔记
categories: []
date: 2018-12-11 09:20:00
---
安卓逆向软件:xpFdex2、dumpDex，开发者助手，mt,np,安卓修改大师
##### 关键跳： 
```
1.常见if跳转  
   ne 改为 eq 
   nez 改为 eqz
   gtz 改为 gez
补充跳转内行  if-eq;if-ne;if-lt;if-ge;if-gt;
以及if-eqz;if-nez;if-ltz;if-gez;if-gtz;if-lez
move-result v1的下面添加以下代码
     const v1 0xffffff 
     const v2 0xffffff
 强跳 goto
 android.permission.SEND_SMS短信删除
进制查找修改 const/16 v4 0x多少
进制强行跳转 const/16  v0  0x3e9
```
##### Smali基本语法
<table><thead><tr><th>指令</th><th>功能</th></tr></thead><tbody><tr><td>.field private isFlag:z</td><td>定义变量</td></tr><tr><td>.method</td><td>方法</td></tr><tr><td>.parameter</td><td>方法参数</td></tr><tr><td>.prologue</td><td>方法开始</td></tr><tr><td>.line 12</td><td>此方法位于12行</td></tr><tr><td>invoke-super</td><td>调用父类方法</td></tr><tr><td>const/high16 v0,0x7fo3</td><td>把0x7fo3赋值给v0</td></tr><tr><td>invoke-direct</td><td>调用函数</td></tr><tr><td>return-void</td><td>函数返回void</td></tr><tr><td>.end method</td><td>函数结束</td></tr><tr><td>new-instance</td><td>创建实例</td></tr><tr><td>input-object</td><td>对象赋值</td></tr><tr><td>iget-object</td><td>调用对象</td></tr><tr><td>Invoke-static</td><td>调用静态函数</td></tr></tbody></table> 

#####  数据类型

<table><thead><tr><th>符号</th><th>类型</th></tr></thead><tbody><tr><td>B</td><td>byte</td></tr><tr><td>C</td><td>char</td></tr><tr><td>D</td><td>double</td></tr><tr><td>F</td><td>float</td></tr><tr><td>I</td><td>int</td></tr><tr><td>J</td><td>long</td></tr><tr><td>S</td><td>short</td></tr><tr><td>V</td><td>void</td></tr><tr><td>Z</td><td>boolean</td></tr><tr><td>[XXX</td><td>Array</td></tr><tr><td>Lxxx/yyy</td><td>Object</td></tr></tbody></table>
```
条件跳转分支：


"if-eq vA, vB, :cond_**"   如果vA等于vB则跳转到:cond_**
"if-ne vA, vB, :cond_**"   如果vA不等于vB则跳转到:cond_**
"if-lt vA, vB, :cond_**"    如果vA小于vB则跳转到:cond_**
"if-ge vA, vB, :cond_**"   如果vA大于等于vB则跳转到:cond_**
"if-gt vA, vB, :cond_**"   如果vA大于vB则跳转到:cond_**
"if-le vA, vB, :cond_**"    如果vA小于等于vB则跳转到:cond_**
"if-eqz vA, :cond_**"   如果vA等于(是)0则跳转到:cond_**
"if-nez vA, :cond_**"   如果vA不等于(不是)0则跳转到:cond_**
"if-ltz vA, :cond_**"    如果vA小于0则跳转到:cond_**
"if-gez vA, :cond_**"   如果vA大于等于0则跳转到:cond_**
"if-gtz vA, :cond_**"   如果vA大于0则跳转到:cond_**
"if-lez vA, :cond_**"    如果vA小于等于0则跳转到:cond_**

```


```  
1:SMS（去除短信权限）
2:setstatusCode（直接跳转到购买成功）
3:支付、支付成功 短信、失败、成功、购买（关键字）
4:const/16  v0  0x3e9(跳转代码！空格是俩个英文空格！）
```
  <!--more-->
典型返回代码                      
 ```
.pswtich_data
     1.swtich_(数字)
     2.swtich_（数字）
.end.pswtich_data1

```
手机上方便的脱壳框架：fdex、微脱壳>合并dex>签名校验>反编译

内购代码
研究出来的
```
 和游戏 onResult，onchinabilling，resulton，Paycenter，Callback
联通：
OnPayResult，PyaResulton，Activity，result，callback
电信：
paySuccess成功，payCancel取消，payFailed失败
移动mm搜索：
onBillingFinish，Billing，CallBack
支付宝和银行卡方法名：handle，message
支付宝搜索字符串9000
发送短信锁定支付模式关键字符串CHINA_TELECOM
中国电信46003，46005，46011CHINA_MOBILE
中国移动46020，重要46000，46002，6007CHINA_UNICOM
中国联通46001，46006，NOT_DEFINE
```